import numpy as np
import pandas as pd
from scipy import stats
import matplotlib.pyplot as plt
from statsmodels.stats.multicomp import pairwise_tukeyhsd
alpha = 0.05
"""baseline (min)"""
# x445 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#   'baseline': [7437, 6435, 6846, 7133, 7993, 9000, 9000, 3980, 9000, 9000, 7388, 6840, 6691, 7121, 8148, 8778, 7441, 8267, 8845, 8949]})

# x480 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#   'baseline': [1911, 1779, 1754, 1847, 2034, 1420, 1299, 964, 1478, 1565, 1351, 1293, 1234, 1347, 1486, 1707, 1492, 1550, 1692, 1749]})

# x515 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#   'baseline': [161, 165, 161, 184, 185, 138, 139, 86, 162, 161, 109, 110, 106, 124, 130, 128, 120, 122, 142, 141]})

"""max"""

# x445 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#   'baseline': [7774, 6724, 7088, 7570, 8389, 9000, 9000, 4108, 9000, 9000, 7585, 7204, 6986, 7510, 8533, 9000, 7848, 8994, 9000, 9000]})

# x480 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [3720, 3915, 3900, 4265, 4612, 2681, 2888, 2341, 3216, 3319, 2782, 3096, 3010, 3372, 3538, 3553, 3599, 3754, 4143, 4226]})

# x515 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [1218, 1420, 1379, 1572, 1709, 883, 1053, 873, 1169, 1213, 983, 1181, 1137, 1318, 1392, 1251, 1385, 1376, 1601, 1674]})

"""mean"""
# x445 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [7623.990099009901, 6569.495049504951, 6968.762376237623, 7362.06, 8206.871287128713, 9000.0, 9000.0, 4028.6831683168316, 9000.0, 9000.0, 7497.732673267326, 7009.821782178218, 6818.990099009901, 7322.564356435643, 8338.841584158416, 8937.09, 7624.445544554455, 8654.990099009901, 8950.79797979798, 8989.4]})

# x480 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [654.6930693069307, 757.0693069306931, 749.6534653465346, 874.48, 911.3366336633663, 485.009900990099, 571.2941176470588, 450.91089108910893, 645.9108910891089, 657.3762376237623, 496.94059405940595, 599.950495049505, 569.049504950495, 682.2475247524752, 723.6039603960396, 638.72, 703.049504950495, 700.3069306930693, 818.989898989899, 861.43]})

# x515 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [654.6930693069307, 757.0693069306931, 749.6534653465346, 874.48, 911.3366336633663, 485.009900990099, 571.2941176470588, 450.91089108910893, 645.9108910891089, 657.3762376237623, 496.94059405940595, 599.950495049505, 569.049504950495, 682.2475247524752, 723.6039603960396, 638.72, 703.049504950495, 700.3069306930693, 818.989898989899, 861.43]})


"""adjusted mean ((max-min)/mean)"""
# x445 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [0.04420257576721734, 0.04399120447191414, 0.034726395726331794, 0.059358386103889396, 0.04825224938291265, 0.0, 0.0, 0.03177216838659415, 0.0, 0.0, 0.026274609750010235, 0.05192714041966576, 0.0432615381041297, 0.05312346618819626, 0.046169482429237865, 0.02484030036622659, 0.05338093079970756, 0.0839977852872606, 0.01731689178437902, 0.0056733486105858015]})

# x480 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [0.6547418967587035, 0.7693152560746863, 0.7680390635242925, 0.7930729115418675, 0.7895123045761623, 0.6268722098351618, 0.7764885115842324, 0.8596461949265688, 0.7509743440557525, 0.7331895820313631, 0.7197830655683822, 0.8515414938438446, 0.8743736229453858, 0.884753813277039, 0.8388867301340587, 0.7245352926400401, 0.8571215679008866, 0.8526863350468471, 0.867071170524104, 0.8518965618046312]})

# x515 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [1.614497005625794, 1.6577082025528354, 1.6247507098989633, 1.5872289817948952, 1.6722689988592536, 1.5360511166455721, 1.5998764415156508, 1.7453559351807122, 1.5590385823995587, 1.600301227502071, 1.7587615309517641, 1.7851472893803118, 1.8117931586456486, 1.7500979581174627, 1.7440479448306059, 1.7582039078156313, 1.7993043037404237, 1.7906434236756161, 1.7814627528367046, 1.7795990388075642]})



"""max-min"""
# x445 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [337, 289, 242, 437, 396, 0, 0, 128, 0, 0, 197, 364, 295, 389, 385, 222, 407, 727, 155, 51]})

# x480 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [1809, 2136, 2146, 2418, 2578, 1261, 1589, 1377, 1738, 1754, 1431, 1803, 1776, 2025, 2052, 1846, 2107, 2204, 2451, 2477]})

# x515 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
#     'baseline': [1057, 1255, 1218, 1388, 1524, 745, 914, 787, 1007, 1052, 874, 1071, 1031, 1194, 1262, 1123, 1265, 1254, 1459, 1533]})




"""dynamic range max/min"""
x445 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
    'baseline': [1.045313970687105, 1.044910644910645, 1.0353491089687408, 1.0612645450721996, 1.0495433504316276, 1.0, 1.0, 1.0321608040201005, 1.0, 1.0, 1.0266648619382783, 1.053216374269006, 1.0440890748767, 1.054627159106867, 1.0472508591065293, 1.0252904989747096, 1.0546969493347669, 1.0879400024192574, 1.0175240248728095, 1.0056989607777405]})

x480 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
    'baseline': [1.946624803767661, 2.2006745362563236, 2.2234891676168758, 2.3091499729290743, 2.2674532940019665, 1.8880281690140845, 2.2232486528098536, 2.4284232365145226, 2.175913396481732, 2.120766773162939, 2.0592153960029607, 2.394431554524362, 2.439222042139384, 2.5033407572383073, 2.380888290713324, 2.0814294083186877, 2.4121983914209117, 2.4219354838709677, 2.448581560283688, 2.4162378502001145]})

x515 = pd.DataFrame({'flip': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
    'baseline': [7.565217391304348, 8.606060606060606, 8.565217391304348, 8.543478260869565, 9.237837837837837, 6.398550724637682, 7.575539568345324, 10.151162790697674, 7.216049382716049, 7.53416149068323, 9.01834862385321, 10.736363636363636, 10.726415094339623, 10.629032258064516, 10.707692307692307, 9.7734375, 11.541666666666666, 11.278688524590164, 11.274647887323944, 11.872340425531915]})










base = [x445,x480,x515]
dist = 'norm'

for i in base:
    if stats.anderson(i.baseline,dist=dist)[0] < stats.anderson(i.baseline,dist='norm')[1][2]:
        print(''.join(['data are ',dist]))
        m_comp = pairwise_tukeyhsd(endog=i['baseline'], groups=i['flip'],alpha=alpha)
        print(m_comp)


    else:
        x = np.linspace(min(i.baseline),max(i.baseline))
        i.hist('baseline',density=True)
        plt.plot(x,stats.norm.pdf(x,loc=np.mean(i.baseline),scale=np.std(i.baseline)))
        plt.show()
        print(''.join(['data are not ',dist]))



